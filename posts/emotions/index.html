<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.88.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>Sentiment Analysis on Texts&nbsp;&ndash;&nbsp;Nived&#39;s Blog</title><link rel="stylesheet" href="/blog/css/core.min.86e97c9ce79d7ff23aa47166ea466e3ce244928ab4d29a809f1f7b896f214f65fc48475a98961c0ee567475b44b7275c.css" integrity="sha384-hul8nOedf/I6pHFm6kZuPOJEkoq00pqAnx97iW8hT2X8SEdamJYcDuVnR1tEtydc"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Sentiment Analysis on Texts" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/blog/"><span class="site name">Nived's Blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="https://nivedwho%2egithub%2eio/"target="_blank" rel="noopener noreferrer">Website</a></nav></div></span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">Sentiment Analysis on Texts</h1><p class="article date"> </p></section><article class="article markdown-body"><p><strong>March 2021</strong> || A project that implements a deep learning model for extracting emotions from the given text.</p>
<p><a href="https://colab.research.google.com/github/nivedwho/Colab/blob/main/ExtractEmotion.ipynb"target="_blank" rel="noopener noreferrer"><img  src="https://colab.research.google.com/assets/colab-badge.svg"
        alt="Open in Colab"/></a>
</p>
<h3 id="basic-steps-involved">Basic Steps Involved</h3>
<h4 id="dataset">Dataset</h4>
<p>The <a href="https://github.com/dair-ai/emotion_dataset"target="_blank" rel="noopener noreferrer">Twitter Emotion Dataset</a>
 is used for training the model. The dataset consinsts of three folders - Train, Test and Labels for test (For evaluating and getting the accuracy). The train folder consists of a large number of tweets labelled with corresponding informations. The Hugging Face&rsquo;s nlp package is downloaded firstly and then the &lsquo;emotion&rsquo; dataset is downloaded from it.</p>
<h4 id="tokenize-the-data">Tokenize the data</h4>
<p>The tweets cannot be passed directly to the model and it requires to be tokenized. Tokenizing involves mapping each unique word to a particular token/number. We also set the limit to 10000 words and other less frequently appering words are ignored.</p>
<pre><code>tokenizer = Tokenizer(num_words=10000, oov_token='&lt;UNK&gt;')

tokenizer.fit_on_texts(tweets)
</code></pre>
<p>After tokeninizing, the tweet &lsquo;I didn&rsquo;t feel humiliated&rsquo; is changed to [2, 139, 3, 679] which the model understands.</p>
<h4 id="padding-and-truncating-data">Padding and truncating data</h4>
<p>The dataset consists of tweets of varying length which can be problematic. After visualizing the dataset it is found that the avg length of tweets are between 10-20 and very few exists with length more than 50. Therefore each tweet is changed to a seqence of length 50 and the ones greater than will be truncated and split.</p>
<p>The classes present in the dataset are &lsquo;joy&rsquo;, &lsquo;sadness&rsquo;, &lsquo;surprise&rsquo;, &lsquo;fear&rsquo;, &lsquo;love&rsquo; and &lsquo;anger&rsquo;. These classes also needs to be labelled from 0-6 before implementing the network.</p>
<h4 id="creating-the-model">Creating the model</h4>
<p>Now that the data is processed to a proper format, model can be created. It is implemented using the sequential class from keras consisting of following layers :</p>
<p><img  src="https://github.com/nivedwho/Images/blob/main/TEmodel.png?raw=true"
        alt="Model"/></p>
<p>Like other multi-class classification problems, here also categorical crossentropy is used as the loss functions.</p>
<h4 id="evaluation">Evaluation</h4>
<p><img  src="https://github.com/nivedwho/Images/blob/main/TEResult.png?raw=true"
        alt="Result"/></p>
<p>The trained model obtained an accuaracy of 80% while working on validation set, which is just good enough.</p>
<p>Also the confusion matrix below justifies the efficiency of the model.
<img  src="https://github.com/nivedwho/Images/blob/main/TEcm.png?raw=true"
        alt="Result"/></p>
<h4 id="working-on-user-input">Working on User Input</h4>
<p>Although the model got good accuracy scores it doesn&rsquo;t mean it will be as good for every user inputs, still it does work for most of the time. This lack of performance shows the need for a better model or a better dataset even.</p></article><section class="article labels"><a class="category" href=/blog/categories/nlp/>NLP</a><a class="category" href=/blog/categories/deep-learning/>Deep Learning</a><a class="category" href=/blog/categories/sentiment-analysis/>Sentiment Analysis</a></section>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/blog/posts/attncnn/"><span class="iconfont icon-article"></span>Attention based CNN for Image Classification</a></p><p><a class="link" href="/blog/posts/climbingcars/"><span class="iconfont icon-article"></span>Summiting mountains using RL</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">Nived's Blog</p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div>
</section></body>

</html>